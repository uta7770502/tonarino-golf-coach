<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ã‚³ãƒ¼ãƒè©³ç´° | ã‚³ãƒ¼ãƒã®è©³ç´°</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .coach-page{max-width:960px;margin:24px auto;padding:16px}
    .coach-hero{display:flex;gap:16px;align-items:center;background:#fff;border-radius:18px;padding:18px;box-shadow:0 6px 20px rgba(0,0,0,.08)}
    .coach-hero img{width:92px;height:92px;border-radius:50%;object-fit:cover}
    .coach-name{font-size:28px;font-weight:800;color:#0b6657;letter-spacing:.04em}
    .stars{display:inline-flex;gap:2px;vertical-align:middle;margin-left:6px}
    .star{font-size:18px;color:#FFD95A}
    .subline{color:#0b6657c0;margin-top:6px}
    .pill-prices{display:flex;gap:8px}
    .pill{background-color:#ffd95a;padding:6px 12px;border-radius:8px;text-align:center;font-weight:bold;color:#333;box-shadow:0 2px 4px rgba(0,0,0,0.1);line-height:1.2}
    .pill p{margin:2px 0;font-size:14px}
    .section-card{background:#fff;border-radius:18px;padding:18px;margin-top:18px;box-shadow:0 6px 20px rgba(0,0,0,.06)}
    .video-wrap{position:relative;aspect-ratio:16/9;border-radius:14px;overflow:hidden}
    .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%}
    .book-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .book-grid input,.book-grid select{width:100%;padding:12px 14px;border:1px solid #e7ecee;border-radius:12px;font-size:16px}
    .btn-primary{display:block;width:100%;text-align:center;background:#FFD95A;border:none;border-radius:14px;padding:16px 18px;font-weight:800;color:#0b6657;margin-top:14px}
    .back-link{display:inline-block;margin:10px 0 0;color:#0b6657;text-decoration:underline}
    @media (max-width:720px){.coach-hero{flex-direction:column;align-items:flex-start}}
  </style>
</head>

<body class="detail">
  <header class="site-header">
    <h1>éš£ã®ã‚´ãƒ«ãƒ•ã‚³ãƒ¼ãƒ</h1>
  </header>

  <main class="coach-page">
    <div class="back-buttons">
  <a class="back-link" href="./student.html">ã‚³ãƒ¼ãƒä¸€è¦§ã«æˆ»ã‚‹</a>
  <a class="back-link mypage-link" href="./student-dashboard.html">ãƒã‚¤ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹</a>
</div>
    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ -->
<section class="coach-hero">
  <div class="coach-info">
    <img id="pPhoto" alt="ã‚³ãƒ¼ãƒå†™çœŸ" class="coach-photo" />
    <div class="coach-text">
      <h2 class="coach-name" id="pName">ã‚³ãƒ¼ãƒå</h2>
      <p class="coach-tagline">
        å¾—æ„ã‚¯ãƒ©ãƒ–ï¼š<span id="pTagline"></span>
      </p>
    </div>
  </div>
</section>

        <div class="pill-prices">
          <div class="pill">
            <p>30åˆ†ãƒ¬ãƒƒã‚¹ãƒ³</p>
            <p><span id="pPrice1">Â¥2,000</span></p>
          </div>
          <div class="pill">
            <p>60åˆ†ãƒ¬ãƒƒã‚¹ãƒ³</p>
            <p><span id="pPrice2">Â¥4,000</span></p>
          </div>
        </div>

        <div class="video-wrap">
          <iframe id="pVideo"
            src="https://www.youtube.com/embed/dQw4w9WgXcQ"
            title="ã‚¹ã‚¤ãƒ³ã‚°å‹•ç”»"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
          </iframe>
        </div>
      </div>
    </section>

    <!-- äºˆç´„ -->
    <section class="section-card">
      <h3 style="margin:0 0 8px;">äºˆç´„</h3>
      <div class="book-grid">
        <input type="date" id="pDate">
        <select id="pTime">
          <option value="14:00-15:00">14:00 - 15:00</option>
          <option value="16:00-17:00">16:00 - 17:00</option>
          <option value="18:00-19:00">18:00 - 19:00</option>
        </select>
        <select id="pDuration">
          <option value="60">60åˆ†</option>
          <option value="90">90åˆ†</option>
        <a id="reserveLink" class="btn btn-outline" style="display:block;text-align:center;margin-top:10px;padding:10px;border-radius:8px;background:#fff;border:1px solid #ccc;color:#0b6657;text-decoration:none;">
  ã“ã®ã‚³ãƒ¼ãƒã‚’äºˆç´„ã™ã‚‹
</a>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const reserveLink = document.getElementById("reserveLink");
  const coachId = new URLSearchParams(window.location.search).get("id");
  if (coachId) {
    reserveLink.href = `reservation.html?id=${coachId}`;
  }
});
</script>
        </select>
        <select id="pPay">
          <option>VISA</option>
          <option>Mastercard</option>
          <option>PayPay</option>
        </select>
      </div>
      <button class="btn-primary" id="pBook">äºˆç´„ã‚’ç¢ºå®šã™ã‚‹</button>
      <p style="margin:10px 0 0;color:#6b7f85;font-size:14px;">â€»ç·´ç¿’å ´åˆ©ç”¨æ–™ã¯åˆ¥é€”ç¾åœ°æ‰•ã„ã¨ãªã‚Šã¾ã™</p>
    </section>

    <!-- ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
    <section class="review-section">
      <h2>ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
      <div id="reviewList" class="review-list">
        <p>ã¾ã ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
      </div>

      <form id="reviewForm" class="review-form">
        <h3>ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›¸ã</h3>
        <label>ãŠåå‰ï¼š</label>
        <input type="text" id="reviewName" required>

        <label>è©•ä¾¡ï¼š</label>
        <select id="reviewRating">
          <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
          <option value="4">â˜…â˜…â˜…â˜…â˜†</option>
          <option value="3">â˜…â˜…â˜…â˜†â˜†</option>
          <option value="2">â˜…â˜…â˜†â˜†â˜†</option>
          <option value="1">â˜…â˜†â˜†â˜†â˜†</option>
        </select>

        <label>ã‚³ãƒ¡ãƒ³ãƒˆï¼š</label>
        <textarea id="reviewComment" rows="3" required></textarea>

        <button type="submit" class="review-btn">æŠ•ç¨¿ã™ã‚‹</button>
      </form>
    </section>
  </main>
<!-- âœ… å›ºå®šãƒŠãƒ“ï¼ˆæˆ»ã‚‹ï¼†ãƒã‚¤ãƒšãƒ¼ã‚¸ï¼‰ -->
<div class="bottom-nav">
  <a href="student.html" class="nav-btn back">ã‚³ãƒ¼ãƒä¸€è¦§</a>
  <a href="student-dashboard.html" class="nav-btn home">ãƒã‚¤ãƒšãƒ¼ã‚¸</a>
</div>
  <script src="./coaches.js"></script>
  <script src="./coach.js"></script>

  <!-- âœ… å…¨æ©Ÿèƒ½çµ±åˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
  <script>
  document.addEventListener("DOMContentLoaded", () => {

    // â¤ï¸ ãŠæ°—ã«å…¥ã‚Š
    const favBtn = document.createElement("button");
    favBtn.textContent = "ğŸ¤ ãŠæ°—ã«å…¥ã‚Šè¿½åŠ ";
    favBtn.style.marginTop = "10px";
    favBtn.style.background = "#ffd95a";
    favBtn.style.border = "none";
    favBtn.style.padding = "6px 10px";
    favBtn.style.borderRadius = "6px";
    favBtn.style.cursor = "pointer";
    document.querySelector(".hero-right")?.appendChild(favBtn);
(document.querySelector(".hero-right") || document.querySelector(".coach-hero"))?.appendChild(favBtn);
    favBtn.addEventListener("click", () => {
      let favorites = JSON.parse(localStorage.getItem("favorites") || "[]");
      const coachData = {
        id: new URLSearchParams(window.location.search).get("id") || "",
        name: document.getElementById("pName")?.textContent || "åå‰ä¸æ˜",
        photo: document.getElementById("pPhoto")?.src || "",
        rating: document.querySelectorAll("#pStars .star")?.length || 5
      };
      const exists = favorites.some((f) => f.id === coachData.id);
      if (exists) {
        favorites = favorites.filter((f) => f.id !== coachData.id);
        localStorage.setItem("favorites", JSON.stringify(favorites));
        favBtn.textContent = "ğŸ¤ ãŠæ°—ã«å…¥ã‚Šè¿½åŠ ";
        alert(`${coachData.name} ã‚’ãŠæ°—ã«å…¥ã‚Šã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ`);
      } else {
        favorites.push(coachData);
        localStorage.setItem("favorites", JSON.stringify(favorites));
        favBtn.textContent = "â¤ï¸ ç™»éŒ²ä¸­";
        alert(`${coachData.name} ã‚’ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸ`);
      }
    });
// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡å‡¦ç†
document.getElementById("sendMessageBtn")?.addEventListener("click", () => {
  const name = document.getElementById("messageName").value;
  const message = document.getElementById("messageText").value;
  const coach = document.getElementById("pName").textContent; // ã‚³ãƒ¼ãƒåå–å¾—

  if (!name || !message) {
    alert("ãŠåå‰ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
    return;
  }

  const messages = JSON.parse(localStorage.getItem("messages")) || [];
  messages.push({
    coach,
    name,
    message,
    date: new Date().toLocaleString()
  });
  localStorage.setItem("messages", JSON.stringify(messages));

  alert("ğŸ“© ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼");
  document.getElementById("messageName").value = "";
  document.getElementById("messageText").value = "";
});
    // ğŸ’¬ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã®è¡¨ç¤ºå‡¦ç†
document.addEventListener("DOMContentLoaded", () => {
  const messageList = document.getElementById("messageList");
  const coach = document.getElementById("pName")?.textContent || "æœªè¨­å®š";

  if (!messageList) return;

  const messages = JSON.parse(localStorage.getItem("messages")) || [];
  const filtered = messages.filter((m) => m.coach === coach);

  if (filtered.length === 0) {
    messageList.innerHTML = "<p>ã¾ã ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
  } else {
    messageList.innerHTML = filtered
      .map(
        (m) =>
          `<div class="message-item">
             <p><strong>${m.name}</strong> (${m.date})</p>
             <p>${m.message}</p>
           </div>`
      )
      .join("");
  }
});
    // âœ… äºˆç´„å‡¦ç†
    const bookBtn = document.querySelector(".btn-primary");
    const dateInput = document.getElementById("pDate");
    const timeSelect = document.getElementById("pTime");
    const durationSelect = document.getElementById("pDuration");
    const paySelect = document.getElementById("pPay");

    if (bookBtn) {
      bookBtn.addEventListener("click", () => {
        const date = dateInput.value || "æ—¥ä»˜æœªé¸æŠ";
        const time = timeSelect.value;
        const duration = durationSelect.value;
        const pay = paySelect.value;
        const coach = document.getElementById("pName")?.textContent || "ä¸æ˜ãªã‚³ãƒ¼ãƒ";

        const booking = { date, time, duration, pay, coach };
        let bookings = JSON.parse(localStorage.getItem("bookings") || "[]");
        bookings.push(booking);
        localStorage.setItem("bookings", JSON.stringify(bookings));

        alert(`âœ… äºˆç´„ãŒå®Œäº†ã—ã¾ã—ãŸï¼\n\nã‚³ãƒ¼ãƒï¼š${coach}\næ—¥æ™‚ï¼š${date} ${time}\næ™‚é–“ï¼š${duration}åˆ†\næ”¯æ‰•ã„ï¼š${pay}`);
      });
    }

    // âœ… ãƒ¬ãƒ“ãƒ¥ãƒ¼
    const reviewForm = document.getElementById("reviewForm");
    const reviewList = document.getElementById("reviewList");
    if (reviewForm) {
      let reviews = JSON.parse(localStorage.getItem("reviews") || "[]");
      renderReviews();

      reviewForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const name = document.getElementById("reviewName").value || "åŒ¿å";
        const rating = document.getElementById("reviewRating").value;
        const comment = document.getElementById("reviewComment").value;
        const newReview = { name, rating, comment, date: new Date().toLocaleDateString() };
        reviews.push(newReview);
        localStorage.setItem("reviews", JSON.stringify(reviews));
        renderReviews();
        reviewForm.reset();
        alert("ğŸ“˜ ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸï¼");
      });

      function renderReviews() {
        reviewList.innerHTML = "";
        if (reviews.length === 0) {
          reviewList.innerHTML = "<p>ã¾ã ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
          return;
        }
        reviews.slice().reverse().forEach((r) => {
          const div = document.createElement("div");
          div.classList.add("review-card");
          div.innerHTML = `
            <p><strong>${r.name}</strong> (${r.date})</p>
            <p>è©•ä¾¡ï¼š${"â˜…".repeat(r.rating)}${"â˜†".repeat(5 - r.rating)}</p>
            <p>${r.comment}</p>
            <hr/>
          `;
          reviewList.appendChild(div);
        });
      }
    }

    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
    const bookingSection = document.querySelector(".section-card");
    if (bookingSection) {
      const msgBtn = document.createElement("button");
      msgBtn.textContent = "ã‚³ãƒ¼ãƒã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹";
      msgBtn.style.marginTop = "15px";
      msgBtn.style.background = "#4caf50";
      msgBtn.style.color = "#fff";
      msgBtn.style.border = "none";
      msgBtn.style.padding = "10px 14px";
      msgBtn.style.borderRadius = "6px";
      msgBtn.style.cursor = "pointer";
      msgBtn.style.width = "100%";
      bookingSection.insertAdjacentElement("afterend", msgBtn);

      const msgForm = document.createElement("div");
      msgForm.innerHTML = `
        <div style="margin-top:10px; background:#f9f9f9; padding:10px; border-radius:6px;">
          <label>ãŠåå‰ï¼š</label><br>
          <input type="text" id="msgName" style="width:100%; margin-bottom:6px;"><br>
          <label>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼š</label><br>
          <textarea id="msgContent" rows="3" style="width:100%;"></textarea><br>
          <button id="sendMsgBtn" style="margin-top:6px; background:#2196f3; color:#fff; border:none; padding:6px 10px; border-radius:4px;">é€ä¿¡</button>
        </div>
      `;
      msgForm.style.display = "none";
      bookingSection.insertAdjacentElement("afterend", msgForm);

      msgBtn.addEventListener("click", () => {
        msgForm.style.display = msgForm.style.display === "none" ? "block" : "none";
      });

      msgForm.querySelector("#sendMsgBtn").addEventListener("click", () => {
        const name = document.getElementById("msgName").value.trim();
        const content = document.getElementById("msgContent").value.trim();
        const coachId = new URLSearchParams(window.location.search).get("id") || "unknown";

        if (!name || !content) {
          alert("åå‰ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
          return;
        }

        const message = { coachId, name, content, date: new Date().toLocaleString() };
        const allMessages = JSON.parse(localStorage.getItem("messages") || "[]");
        allMessages.push(message);
        localStorage.setItem("messages", JSON.stringify(allMessages));

        alert("ğŸ’¬ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼");
        document.getElementById("msgName").value = "";
        document.getElementById("msgContent").value = "";
        msgForm.style.display = "none";
      });
    }
  });
  </script>
</body>
</html>
