<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>コーチ管理 | 隣のゴルフコーチ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="coach-dashboard">
  <header class="site-header">
    <h1>コーチ管理</h1>
  </header>

  <section class="profile-card">
  <img src="https://i.pravatar.cc/150?img=3" alt="コーチ写真" class="profile-img">
  <div class="profile-info">
    <h2>佐藤 コーチ</h2>
    <p class="bio">ドライバー・飛距離アップが得意です！</p>
    <div class="tags">
      <span>#ドライバー</span>
      <span>#アプローチ</span>
    </div>
  </div>
</section>

    <section class="section-card">
      <h3>スタジオ管理</h3>
      <div class="schedule-days">
        <span class="ok">月</span>
        <span class="ok">火</span>
        <span class="ok">水</span>
        <span class="ok">木</span>
        <span class="ng">金</span>
        <span class="ok">土</span>
        <span class="ok">日</span>
      </div>
    </section>

    <section class="section-card">
      <h3>料金設定</h3>
      <!-- ▼ 修正前 -->
<!-- ▼ 修正後 -->
<div class="price-section">
  <p>30分 ¥2,000〜</p>
  <p>60分 ¥3,000〜</p>
  <p>90分 ¥5,000〜</p>
  <button id="editBtn" class="edit-btn">✏️ 編集する</button>
</div>

<!-- ▼ 編集フォーム（最初は非表示） -->
<div id="editForm" class="edit-form" style="display:none;">
  <label>名前：<input type="text" id="editName"></label><br>
  <label>得意クラブ：<input type="text" id="editSpeciality"></label><br>
  <label>紹介文：<textarea id="editIntro"></textarea></label><br>
  <label>30分料金：<input type="number" id="edit30" value="2000"></label><br>
  <label>60分料金：<input type="number" id="edit60" value="3000"></label><br>
  <label>90分料金：<input type="number" id="edit90" value="5000"></label><br>
  <button id="saveBtn"保存</button>
  <button id="cancelBtn">キャンセル</button>
</div>
    </section>
<section class="section-card">
  <h3>スケジュール</h3>
  <div id="schedule-list">
    <ul id="scheduleItems">
      <li>2025-10-10（金） 10:00〜11:00　生徒：山田太郎</li>
    </ul>
  </div>

  <div id="addSchedule">
    <input type="date" id="dateInput">
    <input type="time" id="startInput">
    <input type="time" id="endInput">
    <input type="text" id="studentInput" placeholder="生徒名">
    <button id="addBtn">＋ 追加</button>
  </div>
</section>
    <section class="section-card">
  <h3>今月の売上</h3>
  <div id="sales-container">
    <p>30分レッスン：<input type="number" id="sales30" value="0"> 回</p>
    <p>60分レッスン：<input type="number" id="sales60" value="0"> 回</p>
    <p>90分レッスン：<input type="number" id="sales90" value="0"> 回</p>
    <button id="calcSalesBtn">売上計算</button>
  </div>
  <div id="sales-result">
    <!-- 売上グラフ -->
<section class="section-card">
  <h3>📈 売上推移</h3>
  <canvas id="salesChart" width="400" height="200"></canvas>
</section>
// ===============================
// 売上グラフ機能（修正版）
// ===============================
function updateSalesHistory(total) {
  const now = new Date();
  const month = `${now.getFullYear()}-${now.getMonth() + 1}`;
  let history = JSON.parse(localStorage.getItem("salesHistory")) || {};
  history[month] = total;
  localStorage.setItem("salesHistory", JSON.stringify(history));
  drawSalesChart(history);
}

function drawSalesChart(history) {
  const canvas = document.getElementById("salesChart");
  if (!canvas) return;
  const ctx = canvas.getContext("2d");
  const months = Object.keys(history).slice(-6);
  const totals = months.map(m => history[m]);
  if (window.salesChart) window.salesChart.destroy();
  window.salesChart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: months,
      datasets: [{
        label: "売上合計（円）",
        data: totals,
        backgroundColor: "#4CAF50",
        borderRadius: 6
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true, ticks: { callback: v => "¥" + v.toLocaleString() } } }
    }
  });
}

calcBtn.addEventListener("click", () => {
  const totalText = totalEl.textContent.replace("¥", "").replace(",", "");
  const total = Number(totalText);
  updateSalesHistory(total);
});

window.addEventListener("load", () => {
  const history = JSON.parse(localStorage.getItem("salesHistory")) || {};
  drawSalesChart(history);
});
    <p>売上合計：<strong id="salesTotal">¥0</strong></p>
    <p>入金予定日：<strong id="salesDate"></strong></p>
  </div>
</section>
  </main>

  <footer class="footer-nav">
    <nav>
      <a href="index.html">ホーム</a>
      <a href="#">スケジュール</a>
      <a href="#">売上</a>
      <a href="coach-dashboard.html" class="active">管理</a>
    </nav>
  </footer>
<label>30分料金：<input type="number" id="editPrice30"></label>
<label>60分料金：<input type="number" id="editPrice60"></label>
<label>90分料金：<input type="number" id="editPrice90"></label>
<script>
// ===============================
// スケジュール管理処理（改良版）
// ===============================
const addBtn = document.getElementById("addBtn");
const listEl = document.getElementById("scheduleItems");

// スケジュール一覧を描画
function renderSchedules() {
  listEl.innerHTML = "";
  const schedules = JSON.parse(localStorage.getItem("schedules")) || [];
  schedules.forEach((s, index) => {
    const li = document.createElement("li");
    li.textContent = `${s.date} ${s.start}〜${s.end}（${s.student}）`;

    // 削除ボタン
    const delBtn = document.createElement("button");
    delBtn.textContent = "🗑️";
    delBtn.style.marginLeft = "8px";
    delBtn.addEventListener("click", () => {
      schedules.splice(index, 1);
      localStorage.setItem("schedules", JSON.stringify(schedules));
      renderSchedules();
    });

    li.appendChild(delBtn);
    listEl.appendChild(li);
  });
}

// 登録処理
addBtn.addEventListener("click", () => {
  const date = document.getElementById("dateInput").value;
  const start = document.getElementById("startInput").value;
  const end = document.getElementById("endInput").value;
  const student = document.getElementById("studentInput").value.trim();

  if (!date || !start || !end || !student) {
    alert("すべての項目を入力してください。");
    return;
  }

  const schedules = JSON.parse(localStorage.getItem("schedules")) || [];
  schedules.push({ date, start, end, student });
  localStorage.setItem("schedules", JSON.stringify(schedules));

  renderSchedules();

  // 入力リセット
  document.getElementById("dateInput").value = "";
  document.getElementById("startInput").value = "";
  document.getElementById("endInput").value = "";
  document.getElementById("studentInput").value = "";
});

// 初期ロード時
renderSchedules();

// ページ読み込み時に保存データを反映
window.addEventListener("DOMContentLoaded", () => {
  const saved = JSON.parse(localStorage.getItem("salesData"));
  if (saved) {
    document.getElementById("sales30").value = saved.n30 ?? "";
    document.getElementById("sales60").value = saved.n60 ?? "";
    document.getElementById("sales90").value = saved.n90 ?? "";
    totalEl.textContent = "¥" + saved.total.toLocaleString();
    dateEl.textContent = saved.dateStr;
  }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
